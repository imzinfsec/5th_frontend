<!DOCTYPE html>

<html lang="ko"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Cave Exploration - Guardian</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'cave-dark': '#0f0720',
            'cave-purple': '#2d1b4d',
            'crystal-glow': '#a855f7',
            'gold-accent': '#fbbf24',
          }
        }
      }
    }
  </script>
<style data-purpose="layout-styles">
    body {
      background-color: #0f0720; /* Deep dark cave background */
      color: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      overflow: hidden; /* Prevent scrolling during movement */
    }

    /* Grid Container */
    .game-grid {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      grid-template-rows: repeat(10, 1fr);
      gap: 2px;
      aspect-ratio: 1 / 1;
      width: 100%;
      max-width: 600px;
      border: 4px solid #4a337a;
      background-color: #1a1033;
      box-shadow: 0 0 30px rgba(168, 85, 247, 0.2);
    }

    /* Individual Tile */
    .tile {
      background-color: #2d1b4d;
      border: 1px solid rgba(168, 85, 247, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    /* Player Sprite */
    #player {
      width: 80%;
      height: 80%;
      border-radius: 50%;
      border: 2px solid #fbbf24;
      box-shadow: 0 0 10px #fbbf24;
      z-index: 10;
      transition: all 0.15s ease-out;
    }

    /* Coin Sprite */
    .coin {
      width: 50%;
      height: 50%;
      background-color: #fbbf24;
      border-radius: 50%;
      box-shadow: 0 0 12px #fbbf24;
      animation: pulse 1.5s infinite;
    }

    /* Crystal Decorations (Ambient) */
    .crystal {
      position: absolute;
      width: 20%;
      height: 40%;
      background: linear-gradient(to top, #a855f7, #e879f9);
      clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
      opacity: 0.6;
      filter: blur(1px);
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.8; }
      100% { transform: scale(1); opacity: 1; }
    }
  
    /* Mobile Controls */
    .controls-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      max-width: 500px;
      margin-top: 2rem;
      padding: 0 1rem;
    }

    .dpad {
      display: grid;
      grid-template-columns: repeat(3, 50px);
      grid-template-rows: repeat(3, 50px);
      gap: 5px;
    }

    .control-btn {
      background: rgba(45, 27, 77, 0.8);
      border: 2px solid #4a337a;
      border-radius: 8px;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.1s;
      user-select: none;
    }

    .control-btn:active {
      background: #a855f7;
      transform: scale(0.95);
      box-shadow: 0 0 15px #a855f7;
    }

    .interact-btn {
      width: 100px;
      height: 100px;
      background: radial-gradient(circle, #f59e0b 0%, #d97706 100%);
      border: 4px solid #fbbf24;
      border-radius: 50%;
      color: white;
      font-weight: bold;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
      box-shadow: 0 0 20px rgba(251, 191, 36, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.1s;
      user-select: none;
    }

    .interact-btn:active {
      transform: scale(0.9);
    }

    .btn-up { grid-column: 2; grid-row: 1; }
    .btn-left { grid-column: 1; grid-row: 2; }
    .btn-down { grid-column: 2; grid-row: 3; }
    .btn-right { grid-column: 3; grid-row: 2; }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">
<!-- BEGIN: StatusHeader -->
<header class="w-full max-w-[600px] mb-6 flex items-center justify-between p-4 bg-cave-purple border-2 border-crystal-glow rounded-lg shadow-lg" data-purpose="status-bar">
<div class="flex items-center space-x-4">
<!-- Player Avatar Frame -->
<div class="w-16 h-16 border-2 border-gold-accent rounded-lg overflow-hidden bg-black">
<img alt="Guardian Avatar" class="w-full h-full object-cover" id="avatar-img" src="https://lh3.googleusercontent.com/aida-public/AB6AXuC6xcQnA5HCC6vUPA9Khr5GB4ETixsOH1q801o_JcbrxFTivShNL-Tkf5F2dliDmkDpLNjhr8xTc4cohaZecl949JOqeJbjTfnzdGA8AHuxnatmnEv2-MpMIHob-7e3Xxg_UdUALi_vhbF-7X9NnEm5Uklw033gaVxOPRg7RNxTche4a6jagNxXBIE8R-AT--fjtg8Xj2PkNkgwzd-SUc7CRzfsR3bZqj5JGG5iUQ-5ORz25ZBGIz7-3n3nOYWP3EDt3_oV0mk3OQ"/>
</div>
<div>
<h1 class="text-xl font-bold text-white">수호자 (Guardian)</h1>
<p class="text-sm text-purple-300">Level 2 Cave Exploration</p>
<!-- XP/Health Bar Mockup -->
<div class="w-40 h-2 bg-gray-800 rounded-full mt-1 overflow-hidden">
<div class="bg-gradient-to-r from-purple-500 to-pink-500 h-full" style="width: 45%;"></div>
</div>
</div>
</div>
<div class="text-right">
<div class="text-gold-accent text-2xl font-bold flex items-center justify-end">
<span class="mr-2">Gold:</span>
<span id="gold-count">0</span>
</div>
<button class="mt-2 text-xs text-purple-400 hover:text-white underline transition-colors" onclick="window.location.reload()">Reset Level</button>
</div>
</header>
<!-- END: StatusHeader -->
<!-- BEGIN: NavigationActions -->
<div class="w-full max-w-[600px] mb-4">
<button class="bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded border border-gray-600 transition-all flex items-center gap-2">
<svg class="h-4 w-4" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M10 19l-7-7m0 0l7-7m-7 7h18" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
      Back to Forest
    </button>
</div>
<!-- END: NavigationActions -->
<!-- BEGIN: MainGameArea -->
<main class="relative" data-purpose="game-container">
<!-- Grid -->
<div class="game-grid" data-purpose="map-grid" id="game-grid">
<!-- Generated by JS -->
</div>
<!-- Movement Instructions -->
<p class="mt-4 text-center text-purple-300 text-sm italic">
      방향키(↑ ↓ ← →)를 사용하여 동굴을 탐험하세요.
    </p>
<div class="controls-container mx-auto">
<div class="dpad">
<button class="control-btn btn-up" id="btn-up">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path d="M5 15l7-7 7 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
</button>
<button class="control-btn btn-left" id="btn-left">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path d="M15 19l-7-7 7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
</button>
<button class="control-btn btn-down" id="btn-down">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path d="M19 9l-7 7-7-7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
</button>
<button class="control-btn btn-right" id="btn-right">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path d="M9 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
</button>
</div>
<button class="interact-btn" id="btn-interact">
    INTERACT
  </button>
</div>

</main>
<!-- END: MainGameArea -->
<!-- BEGIN: GameLogic -->
<script data-purpose="game-initialization">
    const GRID_SIZE = 10;
    const gridElement = document.getElementById('game-grid');
    const goldCountElement = document.getElementById('gold-count');
    
    let playerPos = { x: 0, y: 0 };
    let goldCount = 0;
    let grid = [];

    function initGame() {
      gridElement.innerHTML = '';
      grid = Array(GRID_SIZE).fill().map(() => Array(GRID_SIZE).fill(null));

      for (let y = 0; y < GRID_SIZE; y++) {
        for (let x = 0; x < GRID_SIZE; x++) {
          const tile = document.createElement('div');
          tile.className = 'tile';
          tile.id = `tile-${x}-${y}`;
          if (Math.random() > 0.9) {
            const crystal = document.createElement('div');
            crystal.className = 'crystal';
            tile.appendChild(crystal);
          }
          gridElement.appendChild(tile);
        }
      }

      const numCoins = Math.floor(Math.random() * 3) + 3;
      let coinsPlaced = 0;
      while (coinsPlaced < numCoins) {
        let rx = Math.floor(Math.random() * GRID_SIZE);
        let ry = Math.floor(Math.random() * GRID_SIZE);
        if ((rx !== 0 || ry !== 0) && !grid[ry][rx]) {
          grid[ry][rx] = 'coin';
          const coinDiv = document.createElement('div');
          coinDiv.className = 'coin';
          document.getElementById(`tile-${rx}-${ry}`).appendChild(coinDiv);
          coinsPlaced++;
        }
      }
      renderPlayer();
      setupControls();
    }

    function movePlayer(dx, dy) {
      const newX = playerPos.x + dx;
      const newY = playerPos.y + dy;

      if (newX >= 0 && newX < GRID_SIZE && newY >= 0 && newY < GRID_SIZE) {
        playerPos.x = newX;
        playerPos.y = newY;
        renderPlayer();
        return true;
      }
      return false;
    }

    function renderPlayer() {
      const existingPlayer = document.getElementById('player');
      if (existingPlayer) existingPlayer.remove();

      const playerDiv = document.createElement('img');
      playerDiv.id = 'player';
      playerDiv.src = 'https://placehold.co/100x100?text=Guardian';
      playerDiv.alt = 'P';
      
      const targetTile = document.getElementById(`tile-${playerPos.x}-${playerPos.y}`);
      targetTile.appendChild(playerDiv);

      if (grid[playerPos.y][playerPos.x] === 'coin') {
        collectCoin(playerPos.x, playerPos.y);
      }
    }

    function collectCoin(x, y) {
      grid[y][x] = null;
      const tile = document.getElementById(`tile-${x}-${y}`);
      const coinElement = tile.querySelector('.coin');
      if (coinElement) {
        coinElement.remove();
        goldCount++;
        goldCountElement.textContent = goldCount;
        goldCountElement.classList.add('scale-125', 'text-white');
        setTimeout(() => {
          goldCountElement.classList.remove('scale-125', 'text-white');
        }, 200);
      }
    }

    function setupControls() {
      // Keyboard
      window.addEventListener('keydown', (e) => {
        let moved = false;
        switch(e.key) {
          case 'ArrowUp': moved = movePlayer(0, -1); break;
          case 'ArrowDown': moved = movePlayer(0, 1); break;
          case 'ArrowLeft': moved = movePlayer(-1, 0); break;
          case 'ArrowRight': moved = movePlayer(1, 0); break;
        }
        if (moved) e.preventDefault();
      });

      // D-Pad
      document.getElementById('btn-up').addEventListener('click', () => movePlayer(0, -1));
      document.getElementById('btn-down').addEventListener('click', () => movePlayer(0, 1));
      document.getElementById('btn-left').addEventListener('click', () => movePlayer(-1, 0));
      document.getElementById('btn-right').addEventListener('click', () => movePlayer(1, 0));
      
      // Interact Button (can be used for manual collection or other actions later)
      document.getElementById('btn-interact').addEventListener('click', () => {
         if (grid[playerPos.y][playerPos.x] === 'coin') {
           collectCoin(playerPos.x, playerPos.y);
         }
      });
    }

    initGame();
  </script>
<!-- END: GameLogic -->
</body></html><!-- MISSING_IMAGES:
- Guardian character avatar image (used placeholder as per instructions)
-->